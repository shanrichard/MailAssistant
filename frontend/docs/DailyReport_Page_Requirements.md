# DailyReport页面需求文档

**创建日期**: 2025-07-16  
**版本**: 1.0  
**状态**: 待实施

## 📋 页面概述

DailyReport（日报）页面是MailAssistant的核心页面，用户登录后的默认页面。该页面通过智能分析和分类，帮助用户快速了解今日邮件情况，专注于真正重要的内容，减少信息过载带来的压力。

## 🎯 核心业务需求

### 1. 用户痛点
- 每天处理几百封邮件，大部分是噪音（抄送、广告、群发）
- 真正重要的邮件被淹没在大量无关信息中
- 需要逐封查看才能判断重要性，耗时耗力
- 看到大量未读邮件带来心理压力

### 2. 解决方案
- **智能识别重要邮件**：基于用户偏好，识别真正需要关注的邮件
- **LLM驱动的动态分类**：不硬编码分类，由AI根据内容智能分类
- **提供价值反馈**：明确告诉用户节省了多少时间
- **简化批量操作**：一键标记整个分类为已读

### 3. 核心功能需求

#### 3.1 价值展示
- 必须在页面顶部第一眼展示系统价值
- 显示"今天为您节省了 X 分钟"
- 显示"已智能过滤 Y 封邮件"

#### 3.2 重要邮件展示
- **展示所有重要邮件**，不设数量限制
- 每封邮件必须说明"为什么重要"（LLM生成的原因）
- 使用视觉语言（颜色、图标）快速传达邮件性质

#### 3.3 分类邮件展示
- **所有邮件都要展示**，通过分类组织降低认知负担
- 分类完全由LLM动态生成，不能硬编码
- 每个分类必须包含：
  - 分类名称（LLM生成）
  - 邮件数量统计
  - **该分类的内容摘要**（LLM生成，说明这类邮件大概讲了什么）
  - 该分类下的邮件列表（默认展开）
  - 一键标记已读按钮

#### 3.4 邮件信息展示
- 显示：主题、发件人、时间、已读/未读状态
- 不需要显示邮件内容预览

#### 3.5 操作功能
- **手动刷新**：必须提供刷新按钮，重新生成整个日报
- **批量标记已读**：调用Gmail API标记该分类所有邮件为已读
- 不需要手势操作
- 不需要情感展示

### 4. 非功能需求
- 分类顺序按LLM生成的顺序，不需要额外排序
- 刷新时显示"日报生成中"的加载状态
- 标记已读后只改变状态，不移除邮件

## 🎯 设计目标

基于以上需求，设计目标为：
1. **减少信息过载**: 通过智能分类和摘要，让用户不必逐封查看邮件
2. **突出重要内容**: 优先展示需要关注的重要邮件
3. **提供价值反馈**: 明确展示系统为用户节省的时间和精力
4. **简化批量操作**: 一键处理整个分类的邮件

## 📐 页面布局

### 整体结构
```
┌─────────────────────────────────────────────┐
│              顶部价值展示区                   │
├─────────────────────────────────────────────┤
│              重要邮件区                       │
├─────────────────────────────────────────────┤
│              分类邮件区                       │
│                                             │
│              分类1                           │
│              分类2                           │
│              分类3                           │
│              ...                            │
└─────────────────────────────────────────────┘
```

### 1. 顶部价值展示区

**功能**: 展示系统为用户创造的价值，提供刷新操作

**设计要求**:
- 背景色: `bg-blue-50`，边框: `border-b border-blue-100`
- 高度固定，不随内容变化
- 包含三个元素：节省时间统计、过滤邮件统计、刷新按钮

**具体元素**:
1. **节省时间统计**
   - 图标: ClockIcon (蓝色)
   - 文本: "今日节省 X分钟"
   - 数字部分使用醒目颜色 `text-blue-600 font-bold`

2. **过滤邮件统计**
   - 图标: FunnelIcon (绿色)
   - 文本: "智能过滤 Y封"
   - 数字部分使用醒目颜色 `text-green-600 font-bold`

3. **刷新按钮**
   - 位置: 右侧
   - 样式: 白色背景，灰色边框，hover时背景变灰
   - 图标: ArrowPathIcon
   - 文本: "刷新日报"
   - 点击后显示全屏加载状态

### 2. 重要邮件区

**功能**: 展示所有被标记为重要的邮件

**设计要求**:
- 使用警示色背景 `bg-red-50`，边框 `border-red-200`
- 标题包含图标（BoltIcon）和数量统计
- 每封邮件都要说明重要原因

**邮件卡片设计**:
- 背景: 白色
- 边框: `border-red-200` (延续重要性色彩)
- 包含信息:
  - 邮件主题 (font-medium)
  - 发件人 • 时间 (灰色小字)
  - 重要原因说明 (红色小字)
  - 已读/未读状态 (蓝点表示未读)

### 3. 分类邮件区

**功能**: 按LLM智能分类展示所有非重要邮件

**设计要求**:
- 每个分类一个独立卡片
- 分类名称和数量由LLM动态生成
- 包含该分类的内容摘要
- 提供"标记已读"批量操作

**分类卡片结构**:

#### 3.1 分类头部
- 背景: `bg-gray-50`
- 包含元素:
  - 文件夹图标 + 分类名称 + 邮件数量
  - "标记已读"按钮（右侧）
  - 分类摘要（灰色文本，1-2行）

#### 3.2 邮件列表
- 默认展开显示所有邮件
- 每个邮件项包含:
  - 已读/未读标记（蓝点）
  - 邮件主题
  - 发件人
  - 接收时间
- hover效果: `hover:bg-gray-50`

## 🎨 视觉规范

### 颜色系统
- **主色调**: 蓝色系 (Blue-600)
- **重要邮件**: 红色系 (Red-600)
- **成功操作**: 绿色系 (Green-600)
- **普通文本**: 灰色系 (Gray-700/600/500)
- **背景色**: 白色为主，灰色系辅助

### 字体规范
- **页面标题**: text-2xl font-bold
- **区域标题**: text-lg font-semibold
- **邮件主题**: text-sm font-medium
- **辅助信息**: text-sm text-gray-600
- **重要说明**: text-sm text-red-600

### 间距规范
- **区域间距**: mb-6 (24px)
- **卡片内边距**: p-6 (24px) 或 p-4 (16px)
- **列表项间距**: space-y-3 (12px)
- **元素间距**: 遵循4px倍数原则

## 🔄 交互设计

### 1. 页面加载
- 显示加载动画和"正在获取日报..."提示
- 加载完成后平滑过渡显示内容

### 2. 刷新日报
- **触发**: 点击"刷新日报"按钮
- **过程**: 
  - 全屏半透明遮罩
  - 中心显示加载动画
  - 文本: "正在生成最新日报..."
  - 禁用所有交互，防止重复操作
- **完成**: 更新页面数据，显示成功提示

### 3. 标记已读
- **触发**: 点击分类卡片头部的"标记已读"按钮
- **过程**:
  - 按钮变为loading状态
  - 调用Gmail API批量标记
- **完成**:
  - 该分类下所有蓝点消失
  - 显示toast提示"已标记X封邮件为已读"
  - 按钮恢复正常状态

### 4. 邮件点击（预留）
- 点击邮件可跳转查看详情
- 具体行为待后续确定

## 📱 响应式设计

### 移动端适配 (< 768px)
1. **顶部价值展示**:
   - 统计信息改为垂直排列
   - 刷新按钮改为悬浮按钮（右下角）

2. **邮件列表**:
   - 减小内边距和字体
   - 时间显示改为更简短格式
   - 发件人和时间同行显示

3. **分类卡片**:
   - "标记已读"按钮移到分类名称下方
   - 摘要文本最多显示2行

## 🔌 数据结构

### 日报数据格式
```typescript
interface DailyReport {
  // 统计数据
  stats: {
    timeSaved: number;        // 节省的分钟数
    emailsFiltered: number;   // 过滤的邮件数
    totalEmails: number;      // 总邮件数
  };
  
  // 重要邮件
  importantEmails: Array<{
    id: string;
    subject: string;
    sender: string;
    receivedAt: Date;
    isRead: boolean;
    importanceReason: string;  // LLM生成的重要原因
  }>;
  
  // 分类邮件
  categorizedEmails: Array<{
    categoryName: string;      // LLM生成的分类名
    summary: string;           // LLM生成的分类摘要
    emails: Array<{
      id: string;
      subject: string;
      sender: string;
      receivedAt: Date;
      isRead: boolean;
    }>;
  }>;
  
  generatedAt: Date;          // 日报生成时间
}
```

## 🚀 实施要点

1. **LLM驱动的分类**
   - 分类名称、数量、顺序完全由后端LLM决定
   - 前端不做任何硬编码的分类假设
   - 动态渲染所有分类

2. **性能优化**
   - 使用React.memo优化大列表渲染
   - 邮件列表考虑虚拟滚动（如果数量过多）
   - 图片和图标使用懒加载

3. **错误处理**
   - 网络错误时显示友好提示
   - 提供重试机制
   - 标记已读失败时回滚视觉状态

4. **无障碍设计**
   - 所有交互元素都有适当的aria标签
   - 键盘导航支持
   - 适当的颜色对比度

## 📋 开发检查清单

- [ ] 实现顶部价值展示区
- [ ] 实现重要邮件区
- [ ] 实现分类邮件区
- [ ] 实现刷新日报功能
- [ ] 实现标记已读功能
- [ ] 添加加载状态
- [ ] 添加错误处理
- [ ] 响应式设计适配
- [ ] 性能优化
- [ ] 无障碍功能

## 🔄 版本历史

### v1.0 (2025-07-16)
- 初始版本
- 确定基本布局和功能
- 明确交互设计

---

**注**: 本文档会随着项目进展持续更新